var qs = require("querystring"),
	https = require("https");

exports.config = {
		hostname: "browserid.org",
		path: "/verify",
		audience: "http://localhost:8000"
	};

exports.handler = function (reqData, onEnd, onData) {

	reqData.audience = exports.config.audience;
	
	var data = qs.stringify(reqData),
	req = https.request({
		method: "POST",
		path: exports.config.path,
		hostname: exports.config.hostname,
		headers: {
			"Content-Type": "application/x-www-form-urlencoded",
			"Content-Length": data.length
		}
	}, function (res) {

		var body = "";
		
		res.on("data", function (chunk) {
			body += chunk;
		});
		
		res.on("end", function () {
			onEnd(body);
		});
	});
	
	req.on("error", function () {
		console.log(arguments);
	});

	req.end(data);

};